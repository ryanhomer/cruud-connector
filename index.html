<!DOCTYPE html><html class="default" lang="en" data-base="."><head><meta charset="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>@techrah/cruud-connector - v1.0.13</title><meta name="description" content="Documentation for @techrah/cruud-connector"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="assets/style.css"/><link rel="stylesheet" href="assets/highlight.css"/><script defer src="assets/main.js"></script><script async src="assets/icons.js" id="tsd-icons-script"></script><script async src="assets/search.js" id="tsd-search-script"></script><script async src="assets/navigation.js" id="tsd-nav-script"></script><script async src="assets/hierarchy.js" id="tsd-hierarchy-script"></script></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os";document.body.style.display="none";setTimeout(() => app?app.showPage():document.body.style.removeProperty("display"),500)</script><header class="tsd-page-toolbar"><div class="tsd-toolbar-contents container"><div class="table-cell" id="tsd-search"><div class="field"><label for="tsd-search-field" class="tsd-widget tsd-toolbar-icon search no-caption"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><use href="assets/icons.svg#icon-search"></use></svg></label><input type="text" id="tsd-search-field" aria-label="Search"/></div><div class="field"><div id="tsd-toolbar-links"></div></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="index.html" class="title">@techrah/cruud-connector - v1.0.13</a></div><div class="table-cell" id="tsd-widgets"><a href="#" class="tsd-widget tsd-toolbar-icon menu no-caption" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><use href="assets/icons.svg#icon-menu"></use></svg></a></div></div></header><div class="container container-main"><div class="col-content"><div class="tsd-page-title"><h1>@techrah/cruud-connector - v1.0.13</h1></div><div class="tsd-panel tsd-typography"><a id="cruud-connector" class="tsd-anchor"></a><h1 class="tsd-anchor-link">CRUUD Connector<a href="#cruud-connector" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h1><p>A TypeScript library for a layered approach to accessing REST API endpoints.</p>
<p><a href="https://opensource.org/licenses/MIT"><img src="https://img.shields.io/badge/License-MIT-yellow.svg" alt="License: MIT"></a> <img src="https://github.com/techrah/cruud-connector/workflows/publish/badge.svg?branch=master" alt="publish workflow status badge"> <img src="https://codecov.io/gh/techrah/cruud-connector/branch/master/graph/badge.svg?token=BN7T3PAMXF" alt="codecov"></p>
<ul>
<li>UMD format</li>
<li>No external package dependencies</li>
<li>Total size of distribution file is less than 6K</li>
<li>Fully typed with TypeScriptâ„¢</li>
<li>Extensible with custom middleware</li>
</ul>
<p><strong>Why CRUUD (and not CRUD)?</strong></p>
<p>This library emphasizes the use of both UPDATE methods, PATCH and PUT, hence the two U's. They are surfaced as <code>modify</code> and <code>replace</code> respectively. To remove ambiguity, <code>update</code> is not used at all.</p>
<p><strong>Layered</strong></p>
<p>You create a connector and your app communicates with this layer to perform CRUD operations. Requests then pass through zero or more middleware layers. The last layer is the network adapter.</p>
<p>Each middleware layer has a specific purpose independent of the others and allows you to add custom functionality, for example, handling authentication headers and token refreshing.</p>
<p>The last layer is the network layer which is specific to the network API or library you want to use. The default implementation uses <code>fetch</code>. You can create custom network adapters if you'd rather use something else such as <code>XMLHttpRequest</code> or <code>axios</code>. You may even need special adapters for certain types of requests such as handling blobs, for example.</p>
<a id="usage" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Usage<a href="#usage" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><a id="installation" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Installation<a href="#installation" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="bash"><span class="hl-0">npm</span><span class="hl-1"> </span><span class="hl-2">install</span><span class="hl-1"> </span><span class="hl-2">@techrah/cruud-connector</span>
</code><button type="button">Copy</button></pre>

<a id="create-a-connector" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Create a Connector<a href="#create-a-connector" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">applyMiddleware</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">createConnector</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">defaultNetworkAdapter</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">middleware</span><span class="hl-1">,</span><br/><span class="hl-1">} </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;cruud-connector&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">const</span><span class="hl-1"> { </span><span class="hl-6">extractData</span><span class="hl-1">, </span><span class="hl-6">url</span><span class="hl-1"> } = </span><span class="hl-4">middleware</span><span class="hl-1">;</span><br/><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">baseURL</span><span class="hl-1"> = </span><span class="hl-2">&quot;http://api.example.com&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-0">connector</span><span class="hl-1"> = (</span><span class="hl-4">urlPath</span><span class="hl-1">: </span><span class="hl-7">string</span><span class="hl-1">) </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">networkAdapter</span><span class="hl-1"> = </span><span class="hl-0">defaultNetworkAdapter</span><span class="hl-1">(</span><span class="hl-4">baseURL</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-3">return</span><span class="hl-1"> </span><span class="hl-0">createConnector</span><span class="hl-1">(</span><br/><span class="hl-1">    </span><span class="hl-4">networkAdapter</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-0">applyMiddleware</span><span class="hl-1">(</span><span class="hl-0">url</span><span class="hl-1">(</span><span class="hl-4">urlPath</span><span class="hl-1">), </span><span class="hl-4">extractData</span><span class="hl-1">),</span><br/><span class="hl-1">  );</span><br/><span class="hl-1">};</span>
</code><button type="button">Copy</button></pre>

<p>We can now create connectors for specific paths and use them to make CRUD requests.</p>
<pre><code class="typescript"><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">movies</span><span class="hl-1"> = </span><span class="hl-0">connector</span><span class="hl-1">(</span><span class="hl-2">&quot;/movies/&quot;</span><span class="hl-1">);</span><br/><span class="hl-4">movies</span><span class="hl-1">.</span><span class="hl-0">read</span><span class="hl-1">();</span>
</code><button type="button">Copy</button></pre>

<pre><code class="json"><span class="hl-1">[</span><br/><span class="hl-1">  {</span><br/><span class="hl-1">    </span><span class="hl-8">&quot;id&quot;</span><span class="hl-1">: </span><span class="hl-9">1</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-8">&quot;title&quot;</span><span class="hl-1">: </span><span class="hl-2">&quot;Toy Story&quot;</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  {</span><br/><span class="hl-1">    </span><span class="hl-8">&quot;id&quot;</span><span class="hl-1">: </span><span class="hl-9">2</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-8">&quot;title&quot;</span><span class="hl-1">: </span><span class="hl-2">&quot;Jumanji&quot;</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">]</span>
</code><button type="button">Copy</button></pre>

<pre><code class="typescript"><span class="hl-4">movies</span><span class="hl-1">.</span><span class="hl-0">create</span><span class="hl-1">({ </span><span class="hl-4">data:</span><span class="hl-1"> { </span><span class="hl-4">title:</span><span class="hl-1"> </span><span class="hl-2">&quot;Star Wars&quot;</span><span class="hl-1"> } });</span>
</code><button type="button">Copy</button></pre>

<pre><code class="json"><span class="hl-1">{</span><br/><span class="hl-1">  </span><span class="hl-8">&quot;id&quot;</span><span class="hl-1">: </span><span class="hl-9">3</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-8">&quot;title&quot;</span><span class="hl-1">: </span><span class="hl-2">&quot;Star Wars&quot;</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<a id="middleware-1" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Middleware<a href="#middleware-1" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>You can create custom middleware to alter the outgoing request and incoming response. For example, you could write middleware to add authentication headers on outgoing requests or transform incoming data into the shape your app needs. Here are the ones that are already available.</p>
<a id="url" class="tsd-anchor"></a><h4 class="tsd-anchor-link">url<a href="#url" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h4><p>This helps you to build your URL using parameter substitution. For example, to send a GET request for movie with ID #4 in the form <code>http://api.example.com/movies/4/</code>,</p>
<pre><code class="typescript"><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">movie</span><span class="hl-1"> = </span><span class="hl-0">connector</span><span class="hl-1">(</span><span class="hl-2">&quot;/movies/:id/&quot;</span><span class="hl-1">);</span><br/><span class="hl-0">movie</span><span class="hl-1">(</span><span class="hl-9">4</span><span class="hl-1">).</span><span class="hl-0">read</span><span class="hl-1">();</span>
</code><button type="button">Copy</button></pre>

<pre><code class="json"><span class="hl-1">{</span><br/><span class="hl-1">  </span><span class="hl-8">&quot;id&quot;</span><span class="hl-1">: </span><span class="hl-9">4</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-8">&quot;title&quot;</span><span class="hl-1">: </span><span class="hl-2">&quot;Waiting to Exhale&quot;</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<p>Note: The <code>url</code> middleware module does not handle query parameters such as <code>/movies/?id=4&amp;format=json</code>. If you need to handle query parameters, you can copy and extend the existing <code>url</code> module. However, it is easier to let a library such as <code>axios</code> handle this automatically in the network adapter. See later example.</p>
<a id="extractdata" class="tsd-anchor"></a><h4 class="tsd-anchor-link">extractData<a href="#extractdata" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h4><p>This simply extracts the <code>data</code> object from the network response. If you want access to the entire response, (like access to the headers, for example) just leave this out, or create a custom data extractor to suit your specific needs.</p>
<a id="cruud-mappings" class="tsd-anchor"></a><h2 class="tsd-anchor-link">CRUUD mappings<a href="#cruud-mappings" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Here are the CRUD methods that are available when you create a connector and what HTTP methods they invoke. Note that if your network adapter doesn't implement a specific method and you try to use it, the connector will throw an exception.</p>
<table>
<thead>
<tr>
<th>CRUD method</th>
<th>HTTP method</th>
</tr>
</thead>
<tbody>
<tr>
<td>create</td>
<td>POST</td>
</tr>
<tr>
<td>read</td>
<td>GET</td>
</tr>
<tr>
<td>modify</td>
<td>PATCH</td>
</tr>
<tr>
<td>replace</td>
<td>PUT</td>
</tr>
<tr>
<td>delete</td>
<td>DELETE</td>
</tr>
</tbody>
</table>
<a id="the-network-adapter" class="tsd-anchor"></a><h2 class="tsd-anchor-link">The Network Adapter<a href="#the-network-adapter" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The default network adapter uses <code>fetch</code> but you can create your own network adapters and use any library you want, such as <code>axios</code>.</p>
<p>The only requirement is that you implement a function that returns a <code>CRUUDFns</code> (or <code>Partial&lt;CRUUDFns&gt;</code>) object. This object has the CRUD methods you want to implement for this adapter. Each entry returns a <code>CRUUDConnectorFn</code> of the form <code>(req?: CRUUDRequest) =&gt; Promise&lt;any&gt;</code>. An example of a <code>CRUUDFns</code> object that implements the <code>read</code> method is:</p>
<pre><code class="js"><span class="hl-1">{</span><br/><span class="hl-1">  </span><span class="hl-2">&quot;read&quot;</span><span class="hl-1">: (</span><span class="hl-4">req</span><span class="hl-1">) </span><span class="hl-5">=&gt;</span><span class="hl-1"> </span><span class="hl-7">Promise</span><span class="hl-1">.</span><span class="hl-0">resolve</span><span class="hl-1">({ </span><span class="hl-2">&quot;data&quot;</span><span class="hl-4">:</span><span class="hl-1"> {} })</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<p>Here's how you could implement an axios network adapter.</p>
<pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> </span><span class="hl-4">axios</span><span class="hl-1"> </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;axios&quot;</span><span class="hl-1">;</span><br/><span class="hl-3">import</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">createCruudFns</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">CRUUDFns</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">CRUUDRequest</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">CRUUDResponse</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">verifyRequest</span><span class="hl-1">,</span><br/><span class="hl-1">} </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;cruud-connector&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">function</span><span class="hl-1"> </span><span class="hl-0">createNetworkConnector</span><span class="hl-1">(</span><span class="hl-4">axiosConfig</span><span class="hl-1">: </span><span class="hl-7">object</span><span class="hl-1"> = {}): </span><span class="hl-7">CRUUDFns</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-5">function</span><span class="hl-1"> </span><span class="hl-0">doRequest</span><span class="hl-1">(</span><span class="hl-4">req</span><span class="hl-1">: </span><span class="hl-7">CRUUDRequest</span><span class="hl-1"> = {}): </span><span class="hl-7">Promise</span><span class="hl-1">&lt;</span><span class="hl-7">CRUUDResponse</span><span class="hl-1">&gt; {</span><br/><span class="hl-1">    </span><span class="hl-10">// Do some sanity checks.</span><br/><span class="hl-1">    </span><span class="hl-0">verifyRequest</span><span class="hl-1">(</span><span class="hl-4">req</span><span class="hl-1">);</span><br/><br/><span class="hl-1">    </span><span class="hl-10">// Return a promise.</span><br/><span class="hl-1">    </span><span class="hl-3">return</span><span class="hl-1"> </span><span class="hl-0">axios</span><span class="hl-1">({</span><br/><span class="hl-1">      ...</span><span class="hl-4">axiosConfig</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-4">url:</span><span class="hl-1"> </span><span class="hl-4">req</span><span class="hl-1">.</span><span class="hl-4">url</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-4">method:</span><span class="hl-1"> </span><span class="hl-4">req</span><span class="hl-1">.</span><span class="hl-4">httpMethod</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-4">headers:</span><span class="hl-1"> </span><span class="hl-4">req</span><span class="hl-1">.</span><span class="hl-4">headers</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-4">params:</span><span class="hl-1"> </span><span class="hl-4">req</span><span class="hl-1">.</span><span class="hl-4">query</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-4">data:</span><span class="hl-1"> </span><span class="hl-4">req</span><span class="hl-1">.</span><span class="hl-4">data</span><span class="hl-1">,</span><br/><span class="hl-1">    }).</span><span class="hl-0">catch</span><span class="hl-1">((</span><span class="hl-4">e</span><span class="hl-1">) </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-10">// The response may have useful data from the server that you need</span><br/><span class="hl-1">      </span><span class="hl-10">// to act upon but feel free to throw anything you want.</span><br/><span class="hl-1">      </span><span class="hl-3">throw</span><span class="hl-1"> </span><span class="hl-4">e</span><span class="hl-1">.</span><span class="hl-4">response</span><span class="hl-1">;</span><br/><span class="hl-1">    });</span><br/><span class="hl-1">  }</span><br/><br/><span class="hl-1">  </span><span class="hl-10">// Create CRUUD functions that do the requests.</span><br/><span class="hl-1">  </span><span class="hl-10">// Here, they all all identical since axios handles the actual</span><br/><span class="hl-1">  </span><span class="hl-10">// HTTP method which is specified in the request header.</span><br/><span class="hl-1">  </span><span class="hl-10">//</span><br/><span class="hl-1">  </span><span class="hl-10">// The method name is available in case you need to call different</span><br/><span class="hl-1">  </span><span class="hl-10">// request function based on this. Here, we ignore it.</span><br/><span class="hl-1">  </span><span class="hl-10">// If you don&#39;t need it, feel free to just use `() =&gt; ...` instead.</span><br/><span class="hl-1">  </span><span class="hl-3">return</span><span class="hl-1"> </span><span class="hl-0">createCruudFns</span><span class="hl-1">((</span><span class="hl-4">methodName</span><span class="hl-1">: </span><span class="hl-7">string</span><span class="hl-1">) </span><span class="hl-5">=&gt;</span><span class="hl-1"> </span><span class="hl-4">doRequest</span><span class="hl-1">);</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<p>The <code>createCruudFns</code> function simplifies creating the <code>CRUUDFns</code> object. Essentially, for the example given above, it's replacing this:</p>
<pre><code class="typescript"><span class="hl-3">return</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">create:</span><span class="hl-1"> </span><span class="hl-4">doRequest</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">read:</span><span class="hl-1"> </span><span class="hl-4">doRequest</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">modify:</span><span class="hl-1"> </span><span class="hl-4">doRequest</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">replace:</span><span class="hl-1"> </span><span class="hl-4">doRequest</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">delete:</span><span class="hl-1"> </span><span class="hl-4">doRequest</span><span class="hl-1">,</span><br/><span class="hl-1">};</span>
</code><button type="button">Copy</button></pre>

<a id="query-parameters" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Query Parameters<a href="#query-parameters" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Query parameters are not handled in the <code>url</code> module, though you could write a custom module that does.</p>
<p>You may instead choose to pass query parameters into the network adapter since the network library it wraps can usually deal with this already. Notice the line <code>params: req.query</code> in the axios adapter that converts an array of query parameters that was passed in the request.</p>
<p>Using the axios adapter, we can now do a GET request and pass in some parameters.</p>
<pre><code class="typescript"><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">userApi</span><span class="hl-1"> = </span><span class="hl-0">connector</span><span class="hl-1">(</span><span class="hl-2">&quot;/users/&quot;</span><span class="hl-1">);</span><br/><span class="hl-4">userApi</span><span class="hl-1">.</span><span class="hl-0">read</span><span class="hl-1">({ </span><span class="hl-4">query:</span><span class="hl-1"> { </span><span class="hl-4">page:</span><span class="hl-1"> </span><span class="hl-9">2</span><span class="hl-1">, </span><span class="hl-4">pagesize:</span><span class="hl-1"> </span><span class="hl-9">20</span><span class="hl-1"> } });</span>
</code><button type="button">Copy</button></pre>

<p>This would perform a <code>GET</code> request to: <code>http://api.example.com/users/?page=2&amp;pagesize=20</code>.</p>
<a id="custom-middleware" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Custom Middleware<a href="#custom-middleware" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>A middleware module is a function with the following signature:</p>
<pre><code><span class="hl-5">function</span><span class="hl-1"> (</span><span class="hl-4">next</span><span class="hl-1">: </span><span class="hl-7">CRUUDFns</span><span class="hl-1">): </span><span class="hl-7">CRUUDFns</span>
</code><button>Copy</button></pre>

<p>The framework will pass you <code>next</code> which are the CRUD functions in the next layer. You must call all of these functions to keep the chain intact.</p>
<p>Suppose you want to implement a middleware layer that adds an authentication token, here's a trivial implementation.</p>
<pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">createCruudFns</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">CRUUDConnectorFn</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">CRUUDFns</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">CRUUDMethod</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">CRUUDMiddleWareFn</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">CRUUDRequest</span><span class="hl-1">,</span><br/><span class="hl-1">} </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;cruud-connector&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-10">/**</span><br/><span class="hl-10"> * Adds access token to request headers</span><br/><span class="hl-10"> */</span><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-0">withAccessToken</span><span class="hl-1"> = (</span><span class="hl-4">req</span><span class="hl-1">: </span><span class="hl-7">CRUUDRequest</span><span class="hl-1"> = {}) </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-10">// Your custom logic to get the auth token goes here</span><br/><span class="hl-1">  </span><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">authToken</span><span class="hl-1"> = </span><span class="hl-2">&quot;a63b-22f9136-004c&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-1">  </span><span class="hl-10">// Return modified headers that include the auth header.</span><br/><span class="hl-1">  </span><span class="hl-3">return</span><span class="hl-1"> {</span><br/><span class="hl-1">    ...</span><span class="hl-4">req</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-4">headers:</span><span class="hl-1"> {</span><br/><span class="hl-1">      ...</span><span class="hl-4">req</span><span class="hl-1">.</span><span class="hl-4">headers</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-4">Authorization:</span><span class="hl-1"> </span><span class="hl-2">`Bearer </span><span class="hl-5">${</span><span class="hl-4">authToken</span><span class="hl-5">}</span><span class="hl-2">`</span><span class="hl-1">,</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">  };</span><br/><span class="hl-1">};</span><br/><br/><span class="hl-10">/**</span><br/><span class="hl-10"> * Middleware entry point</span><br/><span class="hl-10"> */</span><br/><span class="hl-3">export</span><span class="hl-1"> </span><span class="hl-3">default</span><span class="hl-1"> </span><span class="hl-5">function</span><span class="hl-1"> </span><span class="hl-0">mwAccessToken</span><span class="hl-1">(</span><span class="hl-4">next</span><span class="hl-1">: </span><span class="hl-7">CRUUDFns</span><span class="hl-1">): </span><span class="hl-7">CRUUDFns</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-10">// Return object with supported CRUD functions.</span><br/><span class="hl-1">  </span><span class="hl-10">// Each entry accepts a `CRUUDRequest` object, modifies it,</span><br/><span class="hl-1">  </span><span class="hl-10">// and then inserts it back into the stream via `next`.</span><br/><span class="hl-1">  </span><span class="hl-3">return</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-0">create</span><span class="hl-4">:</span><span class="hl-1"> (</span><span class="hl-4">req</span><span class="hl-1">: </span><span class="hl-7">CRUUDRequest</span><span class="hl-1">) </span><span class="hl-5">=&gt;</span><span class="hl-1"> </span><span class="hl-4">next</span><span class="hl-1">.</span><span class="hl-0">create</span><span class="hl-1">(</span><span class="hl-0">withAccessToken</span><span class="hl-1">(</span><span class="hl-4">req</span><span class="hl-1">)),</span><br/><span class="hl-1">    </span><span class="hl-0">read</span><span class="hl-4">:</span><span class="hl-1"> (</span><span class="hl-4">req</span><span class="hl-1">: </span><span class="hl-7">CRUUDRequest</span><span class="hl-1">) </span><span class="hl-5">=&gt;</span><span class="hl-1"> </span><span class="hl-4">next</span><span class="hl-1">.</span><span class="hl-0">read</span><span class="hl-1">(</span><span class="hl-0">withAccessToken</span><span class="hl-1">(</span><span class="hl-4">req</span><span class="hl-1">)),</span><br/><span class="hl-1">    </span><span class="hl-10">// etc.</span><br/><span class="hl-1">    </span><span class="hl-10">// etc.</span><br/><span class="hl-1">    </span><span class="hl-10">// etc.</span><br/><span class="hl-1">  };</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<p>Alternatively, you can use the <code>createCruudFns</code> helper function to generate the <code>CRUUDFns</code> object.</p>
<pre><code class="typescript"><span class="hl-3">export</span><span class="hl-1"> </span><span class="hl-3">default</span><span class="hl-1"> </span><span class="hl-5">function</span><span class="hl-1"> </span><span class="hl-0">mwAccessToken</span><span class="hl-1">(</span><span class="hl-4">next</span><span class="hl-1">: </span><span class="hl-7">CRUUDFns</span><span class="hl-1">): </span><span class="hl-7">CRUUDFns</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-10">// This function is a factory function which supplies the method name</span><br/><span class="hl-1">  </span><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-0">createConnFn</span><span class="hl-1"> = (</span><span class="hl-4">methodName</span><span class="hl-1">: </span><span class="hl-7">CRUUDMethod</span><span class="hl-1">):</span><br/><span class="hl-1">    </span><span class="hl-10">// Note the similarity to the functions we generated above</span><br/><span class="hl-1">    </span><span class="hl-5">=&gt;</span><span class="hl-1"> (</span><span class="hl-4">req</span><span class="hl-1">: </span><span class="hl-7">CRUUDRequest</span><span class="hl-1"> = {})</span><br/><span class="hl-1">      </span><span class="hl-10">// We create the CRUD function using `next[methodName]`</span><br/><span class="hl-1">      </span><span class="hl-5">=&gt;</span><span class="hl-1"> </span><span class="hl-4">next</span><span class="hl-1">[</span><span class="hl-4">methodName</span><span class="hl-1">](</span><span class="hl-0">withAccessToken</span><span class="hl-1">(</span><span class="hl-4">req</span><span class="hl-1">));</span><br/><br/><span class="hl-1">  </span><span class="hl-10">// The factory function can then be used</span><br/><span class="hl-1">  </span><span class="hl-10">// with `createCruudFns` to generate all the CRUD functions.</span><br/><span class="hl-1">  </span><span class="hl-3">return</span><span class="hl-1"> </span><span class="hl-0">createCruudFns</span><span class="hl-1">(</span><span class="hl-4">createConnFn</span><span class="hl-1">);</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<hr>
<a id="accreditation" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Accreditation<a href="#accreditation" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>This library was inspired by the project @crudlio/crudl-connectors-base which is no longer available for general public consumption. It has therefore been completely re-written from the ground up. Note that there are some differences in usage.</p>
</div></div><div class="col-sidebar"><div class="page-menu"><div class="tsd-navigation settings"><details class="tsd-accordion"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><use href="assets/icons.svg#icon-chevronDown"></use></svg>Settings</h3></summary><div class="tsd-accordion-details"><div class="tsd-filter-visibility"><span class="settings-label">Member Visibility</span><ul id="tsd-filter-options"><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-protected" name="protected"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Protected</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-external" name="external"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>External</span></label></li></ul></div><div class="tsd-theme-toggle"><label class="settings-label" for="tsd-theme">Theme</label><select id="tsd-theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div><details open class="tsd-accordion tsd-page-navigation"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><use href="assets/icons.svg#icon-chevronDown"></use></svg>On This Page</h3></summary><div class="tsd-accordion-details"><a href="#cruud-connector"><span>CRUUD <wbr/>Connector</span></a><ul><li><a href="#usage"><span>Usage</span></a></li><li><ul><li><a href="#installation"><span>Installation</span></a></li><li><a href="#create-a-connector"><span>Create a <wbr/>Connector</span></a></li><li><a href="#middleware-1"><span>Middleware</span></a></li><li><ul><li><a href="#url"><span>url</span></a></li><li><a href="#extractdata"><span>extract<wbr/>Data</span></a></li></ul></li></ul></li><li><a href="#cruud-mappings"><span>CRUUD mappings</span></a></li><li><a href="#the-network-adapter"><span>The <wbr/>Network <wbr/>Adapter</span></a></li><li><ul><li><a href="#query-parameters"><span>Query <wbr/>Parameters</span></a></li></ul></li><li><a href="#custom-middleware"><span>Custom <wbr/>Middleware</span></a></li><li><ul><li><a href="#accreditation"><span>Accreditation</span></a></li></ul></li></ul></div></details></div><div class="site-menu"><nav class="tsd-navigation"><a href="modules.html">@techrah/cruud-connector - v1.0.13</a><ul class="tsd-small-nested-navigation" id="tsd-nav-container"><li>Loading...</li></ul></nav></div></div></div><footer></footer><div class="overlay"></div></body></html>
