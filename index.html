<!doctype html>
<html class="default no-js">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>@techrah/cruud-connector - v1.0.6</title>
	<meta name="description" content="Documentation for @techrah/cruud-connector - v1.0.6">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="assets/css/main.css">
	<script async src="assets/js/search.js" id="search-script"></script>
</head>
<body>
<header>
	<div class="tsd-page-toolbar">
		<div class="container">
			<div class="table-wrap">
				<div class="table-cell" id="tsd-search" data-index="assets/js/search.json" data-base=".">
					<div class="field">
						<label for="tsd-search-field" class="tsd-widget search no-caption">Search</label>
						<input id="tsd-search-field" type="text" />
					</div>
					<ul class="results">
						<li class="state loading">Preparing search index...</li>
						<li class="state failure">The search index is not available</li>
					</ul>
					<a href="index.html" class="title">@techrah/cruud-connector - v1.0.6</a>
				</div>
				<div class="table-cell" id="tsd-widgets">
					<div id="tsd-filter">
						<a href="#" class="tsd-widget options no-caption" data-toggle="options">Options</a>
						<div class="tsd-filter-group">
							<div class="tsd-select" id="tsd-filter-visibility">
								<span class="tsd-select-label">All</span>
								<ul class="tsd-select-list">
									<li data-value="public">Public</li>
									<li data-value="protected">Public/Protected</li>
									<li data-value="private" class="selected">All</li>
								</ul>
							</div>
							<input type="checkbox" id="tsd-filter-inherited" checked />
							<label class="tsd-widget" for="tsd-filter-inherited">Inherited</label>
							<input type="checkbox" id="tsd-filter-externals" checked />
							<label class="tsd-widget" for="tsd-filter-externals">Externals</label>
						</div>
					</div>
					<a href="#" class="tsd-widget menu no-caption" data-toggle="menu">Menu</a>
				</div>
			</div>
		</div>
	</div>
	<div class="tsd-page-title">
		<div class="container">
			<h1>@techrah/cruud-connector - v1.0.6</h1>
		</div>
	</div>
</header>
<div class="container container-main">
	<div class="row">
		<div class="col-8 col-content">
			<div class="tsd-panel tsd-typography">
				<a href="#cruud-connector" id="cruud-connector" style="color: inherit; text-decoration: none;">
					<h1>CRUUD Connector</h1>
				</a>
				<p>A Javascript library for a layered approach to accessing REST API endpoints.</p>
				<p><img src="https://github.com/ryanhomer/cruud-connector/workflows/publish/badge.svg?branch=master" alt="publish workflow status badge"> <img src="https://codecov.io/gh/ryanhomer/cruud-connector/branch/master/graph/badge.svg?token=BN7T3PAMXF" alt="codecov"></p>
				<ul>
					<li>No external package dependencies</li>
					<li>Total size of distribution JS files about 50K</li>
					<li>Fully typed with TypeScript&trade;</li>
					<li>Extensible with custom middleware</li>
				</ul>
				<p><strong>Why CRUUD (and not CRUD)?</strong></p>
				<p>This library emphasizes the use of both UPDATE methods, PATCH and PUT, hence the two U&#39;s. They are surfaced as <code>modify</code> and <code>replace</code> respectively. To remove ambiguity, <code>update</code> is not used at all.</p>
				<p><strong>Layered</strong></p>
				<p>You create a connector and your app communicates with this layer to perform CRUD operations. Requests then pass through zero or more middleware layers. The last layer is the network adapter.</p>
				<p>Each middleware layer has a specific purpose independent of the others and allows you to add custom functionality, for example, handling authentication headers and token refreshing.</p>
				<p>The last layer is the network layer which is specific to the network API or library you want to use. The default implementation uses <code>fetch</code>. You can create custom network adapters if you&#39;d rather use something else such as <code>XMLHttpRequest</code> or <code>axios</code>. You may even need special adapters for certain types of requests such as handling blobs, for example.</p>
				<a href="#usage" id="usage" style="color: inherit; text-decoration: none;">
					<h2>Usage</h2>
				</a>
				<a href="#installation" id="installation" style="color: inherit; text-decoration: none;">
					<h3>Installation</h3>
				</a>
				<pre><code class="language-bash"><span style="color: #000000">npm install @techrah/cruud-connector</span>
</code></pre>
				<a href="#create-a-connector" id="create-a-connector" style="color: inherit; text-decoration: none;">
					<h3>Create a Connector</h3>
				</a>
				<pre><code class="language-typescript"><span style="color: #AF00DB">import</span><span style="color: #000000"> {</span>
<span style="color: #000000">  </span><span style="color: #001080">applyMiddleware</span><span style="color: #000000">,</span>
<span style="color: #000000">  </span><span style="color: #001080">createConnector</span><span style="color: #000000">,</span>
<span style="color: #000000">  </span><span style="color: #001080">defaultNetworkAdapter</span><span style="color: #000000">,</span>
<span style="color: #000000">  </span><span style="color: #001080">middleware</span><span style="color: #000000">,</span>
<span style="color: #000000">} </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;cruud-connector&quot;</span><span style="color: #000000">;</span>

<span style="color: #0000FF">const</span><span style="color: #000000"> { </span><span style="color: #0070C1">extractData</span><span style="color: #000000">, </span><span style="color: #0070C1">url</span><span style="color: #000000"> } = </span><span style="color: #001080">middleware</span><span style="color: #000000">;</span>

<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">baseURL</span><span style="color: #000000"> = </span><span style="color: #A31515">&quot;http://api.example.com&quot;</span><span style="color: #000000">;</span>

<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #795E26">connector</span><span style="color: #000000"> = (</span><span style="color: #001080">urlPath</span><span style="color: #000000">: </span><span style="color: #267F99">string</span><span style="color: #000000">) </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> {</span>
<span style="color: #000000">  </span><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">networkAdapter</span><span style="color: #000000"> = </span><span style="color: #795E26">defaultNetworkAdapter</span><span style="color: #000000">(</span><span style="color: #001080">baseURL</span><span style="color: #000000">);</span>
<span style="color: #000000">  </span><span style="color: #AF00DB">return</span><span style="color: #000000"> </span><span style="color: #795E26">createConnector</span><span style="color: #000000">(</span>
<span style="color: #000000">    </span><span style="color: #001080">networkAdapter</span><span style="color: #000000">,</span>
<span style="color: #000000">    </span><span style="color: #795E26">applyMiddleware</span><span style="color: #000000">(</span><span style="color: #795E26">url</span><span style="color: #000000">(</span><span style="color: #001080">urlPath</span><span style="color: #000000">), </span><span style="color: #001080">extractData</span><span style="color: #000000">),</span>
<span style="color: #000000">  );</span>
<span style="color: #000000">};</span>
</code></pre>
				<p>We can now create connectors for specific paths and use them to make CRUD requests.</p>
				<pre><code class="language-typescript"><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">movies</span><span style="color: #000000"> = </span><span style="color: #795E26">connector</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;/movies/&quot;</span><span style="color: #000000">);</span>
<span style="color: #001080">movies</span><span style="color: #000000">.</span><span style="color: #795E26">read</span><span style="color: #000000">();</span>
</code></pre>
				<pre><code class="language-json"><span style="color: #000000">[</span>
<span style="color: #000000">  {</span>
<span style="color: #000000">    </span><span style="color: #0451A5">&quot;id&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1</span><span style="color: #000000">,</span>
<span style="color: #000000">    </span><span style="color: #0451A5">&quot;title&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;Toy Story&quot;</span>
<span style="color: #000000">  },</span>
<span style="color: #000000">  {</span>
<span style="color: #000000">    </span><span style="color: #0451A5">&quot;id&quot;</span><span style="color: #000000">: </span><span style="color: #098658">2</span><span style="color: #000000">,</span>
<span style="color: #000000">    </span><span style="color: #0451A5">&quot;title&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;Jumanji&quot;</span>
<span style="color: #000000">  }</span>
<span style="color: #000000">]</span>
</code></pre>
				<pre><code class="language-typescript"><span style="color: #001080">movies</span><span style="color: #000000">.</span><span style="color: #795E26">create</span><span style="color: #000000">({ </span><span style="color: #001080">data:</span><span style="color: #000000"> { </span><span style="color: #001080">title:</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;Star Wars&quot;</span><span style="color: #000000"> } });</span>
</code></pre>
				<pre><code class="language-json"><span style="color: #000000">{</span>
<span style="color: #000000">  </span><span style="color: #0451A5">&quot;id&quot;</span><span style="color: #000000">: </span><span style="color: #098658">3</span><span style="color: #000000">,</span>
<span style="color: #000000">  </span><span style="color: #0451A5">&quot;title&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;Star Wars&quot;</span>
<span style="color: #000000">}</span>
</code></pre>
				<a href="#middleware" id="middleware" style="color: inherit; text-decoration: none;">
					<h3>Middleware</h3>
				</a>
				<p>You can create custom middleware to alter the outgoing request and incoming response. For example, you could write middleware to add authentication headers on outgoing requests or transform incoming data into the shape your app needs. Here are the ones that are already available.</p>
				<a href="#url" id="url" style="color: inherit; text-decoration: none;">
					<h4>url</h4>
				</a>
				<p>This helps you to build your URL using parameter substitution. For example, to send a GET request for movie with ID #4 in the form <code>http://api.example.com/movies/4/</code>,</p>
				<pre><code class="language-typescript"><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">movie</span><span style="color: #000000"> = </span><span style="color: #795E26">connector</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;/movies/:id/&quot;</span><span style="color: #000000">);</span>
<span style="color: #795E26">movie</span><span style="color: #000000">(</span><span style="color: #098658">4</span><span style="color: #000000">).</span><span style="color: #795E26">read</span><span style="color: #000000">();</span>
</code></pre>
				<pre><code class="language-json"><span style="color: #000000">{</span>
<span style="color: #000000">  </span><span style="color: #0451A5">&quot;id&quot;</span><span style="color: #000000">: </span><span style="color: #098658">4</span><span style="color: #000000">,</span>
<span style="color: #000000">  </span><span style="color: #0451A5">&quot;title&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;Waiting to Exhale&quot;</span>
<span style="color: #000000">}</span>
</code></pre>
				<p>Note: The <code>url</code> middleware module does not handle query parameters such as <code>/movies/?id=4&amp;format=json</code>. If you need to handle query parameters, you can copy and extend the existing <code>url</code> module. However, it is easier to let a library such as <code>axios</code> handle this automatically in the network adapter. See later example.</p>
				<a href="#extractdata" id="extractdata" style="color: inherit; text-decoration: none;">
					<h4>extractData</h4>
				</a>
				<p>This simply extracts the <code>data</code> object from the network response. If you want access to the entire response, (like access to the headers, for example) just leave this out, or create a custom data extractor to suit your specific needs.</p>
				<a href="#cruud-mappings" id="cruud-mappings" style="color: inherit; text-decoration: none;">
					<h2>CRUUD mappings</h2>
				</a>
				<p>Here are the CRUD methods that are available when you create a connector and what HTTP methods they invoke. Note that if your network adapter doesn&#39;t implement a specific method and you try to use it, the connector will throw an exception.</p>
				<table>
					<thead>
						<tr>
							<th>CRUD method</th>
							<th>HTTP method</th>
						</tr>
					</thead>
					<tbody><tr>
							<td>create</td>
							<td>POST</td>
						</tr>
						<tr>
							<td>read</td>
							<td>GET</td>
						</tr>
						<tr>
							<td>modify</td>
							<td>PATCH</td>
						</tr>
						<tr>
							<td>replace</td>
							<td>PUT</td>
						</tr>
						<tr>
							<td>delete</td>
							<td>DELETE</td>
						</tr>
				</tbody></table>
				<a href="#the-network-adapter" id="the-network-adapter" style="color: inherit; text-decoration: none;">
					<h2>The Network Adapter</h2>
				</a>
				<p>The default network adapter uses <code>fetch</code> but you can create your own network adapters and use any library you want, such as <code>axios</code>.</p>
				<p>The only requirement is that you implement a function that returns a <code>CRUUDFns</code> (or <code>Partial&lt;CRUUDFns&gt;</code>) object. This object has the CRUD methods you want to implement for this adapter. Each entry returns a <code>CRUUDConnectorFn</code> of the form <code>(req?: CRUUDRequest) =&gt; Promise&lt;any&gt;</code>. An example of a <code>CRUUDFns</code> object that implements the <code>read</code> method is:</p>
				<pre><code class="language-js"><span style="color: #000000">{</span>
<span style="color: #000000">  </span><span style="color: #A31515">&quot;read&quot;</span><span style="color: #000000">: (</span><span style="color: #001080">req</span><span style="color: #000000">) </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> </span><span style="color: #267F99">Promise</span><span style="color: #000000">.</span><span style="color: #795E26">resolve</span><span style="color: #000000">({ </span><span style="color: #A31515">&quot;data&quot;</span><span style="color: #001080">:</span><span style="color: #000000"> {} })</span>
<span style="color: #000000">}</span>
</code></pre>
				<p>Here&#39;s how you could implement an axios network adapter.</p>
				<pre><code class="language-typescript"><span style="color: #AF00DB">import</span><span style="color: #000000"> </span><span style="color: #001080">axios</span><span style="color: #000000"> </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;axios&quot;</span><span style="color: #000000">;</span>
<span style="color: #AF00DB">import</span><span style="color: #000000"> {</span>
<span style="color: #000000">  </span><span style="color: #001080">createCruudFns</span><span style="color: #000000">,</span>
<span style="color: #000000">  </span><span style="color: #001080">CRUUDFns</span><span style="color: #000000">,</span>
<span style="color: #000000">  </span><span style="color: #001080">CRUUDRequest</span><span style="color: #000000">,</span>
<span style="color: #000000">  </span><span style="color: #001080">CRUUDResponse</span><span style="color: #000000">,</span>
<span style="color: #000000">  </span><span style="color: #001080">verifyRequest</span><span style="color: #000000">,</span>
<span style="color: #000000">} </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;cruud-connector&quot;</span><span style="color: #000000">;</span>

<span style="color: #0000FF">function</span><span style="color: #000000"> </span><span style="color: #795E26">createNetworkConnector</span><span style="color: #000000">(</span><span style="color: #001080">axiosConfig</span><span style="color: #000000">: </span><span style="color: #267F99">object</span><span style="color: #000000"> = {}): </span><span style="color: #267F99">CRUUDFns</span><span style="color: #000000"> {</span>
<span style="color: #000000">  </span><span style="color: #0000FF">function</span><span style="color: #000000"> </span><span style="color: #795E26">doRequest</span><span style="color: #000000">(</span><span style="color: #001080">req</span><span style="color: #000000">: </span><span style="color: #267F99">CRUUDRequest</span><span style="color: #000000"> = {}): </span><span style="color: #267F99">Promise</span><span style="color: #000000">&lt;</span><span style="color: #267F99">CRUUDResponse</span><span style="color: #000000">&gt; {</span>
<span style="color: #000000">    </span><span style="color: #008000">// Do some sanity checks.</span>
<span style="color: #000000">    </span><span style="color: #795E26">verifyRequest</span><span style="color: #000000">(</span><span style="color: #001080">req</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #008000">// Return a promise.</span>
<span style="color: #000000">    </span><span style="color: #AF00DB">return</span><span style="color: #000000"> </span><span style="color: #795E26">axios</span><span style="color: #000000">({</span>
<span style="color: #000000">      ...</span><span style="color: #001080">axiosConfig</span><span style="color: #000000">,</span>
<span style="color: #000000">      </span><span style="color: #001080">url:</span><span style="color: #000000"> </span><span style="color: #001080">req</span><span style="color: #000000">.</span><span style="color: #001080">url</span><span style="color: #000000">,</span>
<span style="color: #000000">      </span><span style="color: #001080">method:</span><span style="color: #000000"> </span><span style="color: #001080">req</span><span style="color: #000000">.</span><span style="color: #001080">httpMethod</span><span style="color: #000000">,</span>
<span style="color: #000000">      </span><span style="color: #001080">headers:</span><span style="color: #000000"> </span><span style="color: #001080">req</span><span style="color: #000000">.</span><span style="color: #001080">headers</span><span style="color: #000000">,</span>
<span style="color: #000000">      </span><span style="color: #001080">params:</span><span style="color: #000000"> </span><span style="color: #001080">req</span><span style="color: #000000">.</span><span style="color: #001080">query</span><span style="color: #000000">,</span>
<span style="color: #000000">      </span><span style="color: #001080">data:</span><span style="color: #000000"> </span><span style="color: #001080">req</span><span style="color: #000000">.</span><span style="color: #001080">data</span><span style="color: #000000">,</span>
<span style="color: #000000">    }).</span><span style="color: #795E26">catch</span><span style="color: #000000">((</span><span style="color: #001080">e</span><span style="color: #000000">) </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> {</span>
<span style="color: #000000">      </span><span style="color: #008000">// The response may have useful data from the server that you need</span>
<span style="color: #000000">      </span><span style="color: #008000">// to act upon but feel free to throw anything you want.</span>
<span style="color: #000000">      </span><span style="color: #AF00DB">throw</span><span style="color: #000000"> </span><span style="color: #001080">e</span><span style="color: #000000">.</span><span style="color: #001080">response</span><span style="color: #000000">;</span>
<span style="color: #000000">    });</span>
<span style="color: #000000">  }</span>

<span style="color: #000000">  </span><span style="color: #008000">// Create CRUUD functions that do the requests.</span>
<span style="color: #000000">  </span><span style="color: #008000">// Here, they all all identical since axios handles the actual HTTP method</span>
<span style="color: #000000">  </span><span style="color: #008000">// which is specified in the request header.</span>
<span style="color: #000000">  </span><span style="color: #008000">//</span>
<span style="color: #000000">  </span><span style="color: #008000">// The method name is available in case you need to call different</span>
<span style="color: #000000">  </span><span style="color: #008000">// request function based on this. Here, we ignore it.</span>
<span style="color: #000000">  </span><span style="color: #008000">// If you don&#039;t need it, feel free to just use `() =&gt; ...` instead.</span>
<span style="color: #000000">  </span><span style="color: #AF00DB">return</span><span style="color: #000000"> </span><span style="color: #795E26">createCruudFns</span><span style="color: #000000">((</span><span style="color: #001080">methodName</span><span style="color: #000000">: </span><span style="color: #267F99">string</span><span style="color: #000000">) </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> </span><span style="color: #001080">doRequest</span><span style="color: #000000">);</span>
<span style="color: #000000">}</span>
</code></pre>
				<p>The <code>createCruudFns</code> function simplifies creating the <code>CRUUDFns</code> object. Essentially, for the example given above, it&#39;s replacing this:</p>
				<pre><code class="language-typescript"><span style="color: #AF00DB">return</span><span style="color: #000000"> {</span>
<span style="color: #000000">  </span><span style="color: #001080">create:</span><span style="color: #000000"> </span><span style="color: #001080">doRequest</span><span style="color: #000000">,</span>
<span style="color: #000000">  </span><span style="color: #001080">read:</span><span style="color: #000000"> </span><span style="color: #001080">doRequest</span><span style="color: #000000">,</span>
<span style="color: #000000">  </span><span style="color: #001080">modify:</span><span style="color: #000000"> </span><span style="color: #001080">doRequest</span><span style="color: #000000">,</span>
<span style="color: #000000">  </span><span style="color: #001080">replace:</span><span style="color: #000000"> </span><span style="color: #001080">doRequest</span><span style="color: #000000">,</span>
<span style="color: #000000">  </span><span style="color: #001080">delete:</span><span style="color: #000000"> </span><span style="color: #001080">doRequest</span><span style="color: #000000">,</span>
<span style="color: #000000">};</span>
</code></pre>
				<a href="#query-parameters" id="query-parameters" style="color: inherit; text-decoration: none;">
					<h3>Query Parameters</h3>
				</a>
				<p>Query parameters are not handled in the <code>url</code> module, though you could write a custom module that does.</p>
				<p>You may instead choose to pass query parameters into the network adapter since the network library it wraps can usually deal with this already. Notice the line <code>params: req.query</code> in the axios adapter that converts an array of query parameters that was passed in the request.</p>
				<p>Using the axios adapter, we can now do a GET request and pass in some parameters.</p>
				<pre><code class="language-typescript"><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">userApi</span><span style="color: #000000"> = </span><span style="color: #795E26">connector</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;/users/&quot;</span><span style="color: #000000">);</span>
<span style="color: #001080">userApi</span><span style="color: #000000">.</span><span style="color: #795E26">read</span><span style="color: #000000">({ </span><span style="color: #001080">query:</span><span style="color: #000000"> { </span><span style="color: #001080">page:</span><span style="color: #000000"> </span><span style="color: #098658">2</span><span style="color: #000000">, </span><span style="color: #001080">pagesize:</span><span style="color: #000000"> </span><span style="color: #098658">20</span><span style="color: #000000"> } });</span>
</code></pre>
				<p>This would perform a <code>GET</code> request to: <code>http://api.example.com/users/?page=2&amp;pagesize=20</code>.</p>
				<a href="#custom-middleware" id="custom-middleware" style="color: inherit; text-decoration: none;">
					<h2>Custom Middleware</h2>
				</a>
				<p>A middleware module is a function with the following signature:</p>
				<pre><code><span style="color: #0000FF">function</span><span style="color: #000000"> (</span><span style="color: #001080">next</span><span style="color: #000000">: </span><span style="color: #267F99">CRUUDFns</span><span style="color: #000000">): </span><span style="color: #267F99">CRUUDFns</span>
</code></pre>
				<p>The framework will pass you <code>next</code> which are the CRUD functions in the next layer. You must call all of these functions to keep the chain intact.</p>
				<p>Suppose you want to implement a middleware layer that adds an authentication token, here&#39;s a trivial implementation.</p>
				<pre><code class="language-typescript"><span style="color: #AF00DB">import</span><span style="color: #000000"> {</span>
<span style="color: #000000">  </span><span style="color: #001080">createCruudFns</span><span style="color: #000000">,</span>
<span style="color: #000000">  </span><span style="color: #001080">CRUUDConnectorFn</span><span style="color: #000000">,</span>
<span style="color: #000000">  </span><span style="color: #001080">CRUUDFns</span><span style="color: #000000">,</span>
<span style="color: #000000">  </span><span style="color: #001080">CRUUDMethod</span><span style="color: #000000">,</span>
<span style="color: #000000">  </span><span style="color: #001080">CRUUDMiddleWareFn</span><span style="color: #000000">,</span>
<span style="color: #000000">  </span><span style="color: #001080">CRUUDRequest</span><span style="color: #000000">,</span>
<span style="color: #000000">} </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;cruud-connector&quot;</span><span style="color: #000000">;</span>

<span style="color: #008000">/**</span>
<span style="color: #008000"> * Adds access token to request headers</span>
<span style="color: #008000"> */</span>
<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #795E26">withAccessToken</span><span style="color: #000000"> = (</span><span style="color: #001080">req</span><span style="color: #000000">: </span><span style="color: #267F99">CRUUDRequest</span><span style="color: #000000"> = {}) </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> {</span>
<span style="color: #000000">  </span><span style="color: #008000">// Your custom logic to get the auth token goes here</span>
<span style="color: #000000">  </span><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">authToken</span><span style="color: #000000"> = </span><span style="color: #A31515">&quot;a63b-22f9136-004c&quot;</span><span style="color: #000000">;</span>

<span style="color: #000000">  </span><span style="color: #008000">// Return modified headers that include the auth header.</span>
<span style="color: #000000">  </span><span style="color: #AF00DB">return</span><span style="color: #000000"> {</span>
<span style="color: #000000">    ...</span><span style="color: #001080">req</span><span style="color: #000000">,</span>
<span style="color: #000000">    </span><span style="color: #001080">headers:</span><span style="color: #000000"> {</span>
<span style="color: #000000">      ...</span><span style="color: #001080">req</span><span style="color: #000000">.</span><span style="color: #001080">headers</span><span style="color: #000000">,</span>
<span style="color: #000000">      </span><span style="color: #001080">Authorization:</span><span style="color: #000000"> </span><span style="color: #A31515">`Bearer </span><span style="color: #0000FF">${</span><span style="color: #001080">authToken</span><span style="color: #0000FF">}</span><span style="color: #A31515">`</span><span style="color: #000000">,</span>
<span style="color: #000000">    },</span>
<span style="color: #000000">  };</span>
<span style="color: #000000">};</span>

<span style="color: #008000">/**</span>
<span style="color: #008000"> * Middleware entry point</span>
<span style="color: #008000"> */</span>
<span style="color: #AF00DB">export</span><span style="color: #000000"> </span><span style="color: #AF00DB">default</span><span style="color: #000000"> </span><span style="color: #0000FF">function</span><span style="color: #000000"> </span><span style="color: #795E26">mwAccessToken</span><span style="color: #000000">(</span><span style="color: #001080">next</span><span style="color: #000000">: </span><span style="color: #267F99">CRUUDFns</span><span style="color: #000000">): </span><span style="color: #267F99">CRUUDFns</span><span style="color: #000000"> {</span>
<span style="color: #000000">  </span><span style="color: #008000">// Return object with supported CRUD functions.</span>
<span style="color: #000000">  </span><span style="color: #008000">// Each entry accepts a `CRUUDRequest` object, modifies it,</span>
<span style="color: #000000">  </span><span style="color: #008000">// and then inserts it back into the stream via `next`.</span>
<span style="color: #000000">  </span><span style="color: #AF00DB">return</span><span style="color: #000000"> {</span>
<span style="color: #000000">    </span><span style="color: #795E26">create</span><span style="color: #001080">:</span><span style="color: #000000"> (</span><span style="color: #001080">req</span><span style="color: #000000">: </span><span style="color: #267F99">CRUUDRequest</span><span style="color: #000000">) </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> </span><span style="color: #001080">next</span><span style="color: #000000">.</span><span style="color: #795E26">create</span><span style="color: #000000">(</span><span style="color: #795E26">withAccessToken</span><span style="color: #000000">(</span><span style="color: #001080">req</span><span style="color: #000000">)),</span>
<span style="color: #000000">    </span><span style="color: #795E26">read</span><span style="color: #001080">:</span><span style="color: #000000"> (</span><span style="color: #001080">req</span><span style="color: #000000">: </span><span style="color: #267F99">CRUUDRequest</span><span style="color: #000000">) </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> </span><span style="color: #001080">next</span><span style="color: #000000">.</span><span style="color: #795E26">read</span><span style="color: #000000">(</span><span style="color: #795E26">withAccessToken</span><span style="color: #000000">(</span><span style="color: #001080">req</span><span style="color: #000000">)),</span>
<span style="color: #000000">    </span><span style="color: #008000">// etc.</span>
<span style="color: #000000">    </span><span style="color: #008000">// etc.</span>
<span style="color: #000000">    </span><span style="color: #008000">// etc.</span>
<span style="color: #000000">  };</span>
<span style="color: #000000">}</span>
</code></pre>
				<p>Alternatively, you can use the <code>createCruudFns</code> helper function to generate the <code>CRUUDFns</code> object.</p>
				<pre><code class="language-typescript"><span style="color: #AF00DB">export</span><span style="color: #000000"> </span><span style="color: #AF00DB">default</span><span style="color: #000000"> </span><span style="color: #0000FF">function</span><span style="color: #000000"> </span><span style="color: #795E26">mwAccessToken</span><span style="color: #000000">(</span><span style="color: #001080">next</span><span style="color: #000000">: </span><span style="color: #267F99">CRUUDFns</span><span style="color: #000000">): </span><span style="color: #267F99">CRUUDFns</span><span style="color: #000000"> {</span>
<span style="color: #000000">  </span><span style="color: #008000">// This function is a factory function which supplies the method name</span>
<span style="color: #000000">  </span><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #795E26">createConnFn</span><span style="color: #000000"> = (</span><span style="color: #001080">methodName</span><span style="color: #000000">: </span><span style="color: #267F99">CRUUDMethod</span><span style="color: #000000">):</span>
<span style="color: #000000">    </span><span style="color: #008000">// Note the similarity to the functions we generated above</span>
<span style="color: #000000">    </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> (</span><span style="color: #001080">req</span><span style="color: #000000">: </span><span style="color: #267F99">CRUUDRequest</span><span style="color: #000000"> = {})</span>
<span style="color: #000000">      </span><span style="color: #008000">// We create the CRUD function using `next[methodName]`</span>
<span style="color: #000000">      </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> </span><span style="color: #001080">next</span><span style="color: #000000">[</span><span style="color: #001080">methodName</span><span style="color: #000000">](</span><span style="color: #795E26">withAccessToken</span><span style="color: #000000">(</span><span style="color: #001080">req</span><span style="color: #000000">));</span>

<span style="color: #000000">  </span><span style="color: #008000">// The factory function can then be used</span>
<span style="color: #000000">  </span><span style="color: #008000">// with `createCruudFns` to generate all the CRUD functions.</span>
<span style="color: #000000">  </span><span style="color: #AF00DB">return</span><span style="color: #000000"> </span><span style="color: #795E26">createCruudFns</span><span style="color: #000000">(</span><span style="color: #001080">createConnFn</span><span style="color: #000000">);</span>
<span style="color: #000000">}</span>
</code></pre>
				<hr>
				<a href="#accreditation" id="accreditation" style="color: inherit; text-decoration: none;">
					<h3>Accreditation</h3>
				</a>
				<p>This library was inspired by the project @crudlio/crudl-connectors-base which is no longer available for general public consumption. It has therefore been completely re-written from the ground up. Note that there are some differences in usage.</p>
			</div>
		</div>
		<div class="col-4 col-menu menu-sticky-wrap menu-highlight">
			<nav class="tsd-navigation primary">
				<ul>
					<li class=" ">
						<a href="modules.html">Exports</a>
					</li>
					<li class=" tsd-kind-namespace">
						<a href="modules/middleware.html">middleware</a>
					</li>
				</ul>
			</nav>
			<nav class="tsd-navigation secondary menu-sticky">
				<ul class="before-current">
					<li class=" tsd-kind-interface">
						<a href="interfaces/cruudconnector.html" class="tsd-kind-icon">CRUUDConnector</a>
					</li>
					<li class=" tsd-kind-interface">
						<a href="interfaces/cruudfns.html" class="tsd-kind-icon">CRUUDFns</a>
					</li>
					<li class=" tsd-kind-type-alias">
						<a href="modules.html#cruudconnectorfn" class="tsd-kind-icon">CRUUDConnector<wbr>Fn</a>
					</li>
					<li class=" tsd-kind-type-alias">
						<a href="modules.html#cruudmethod" class="tsd-kind-icon">CRUUDMethod</a>
					</li>
					<li class=" tsd-kind-type-alias">
						<a href="modules.html#cruudmiddlewarefn" class="tsd-kind-icon">CRUUDMiddle<wbr>Ware<wbr>Fn</a>
					</li>
					<li class=" tsd-kind-type-alias">
						<a href="modules.html#cruudmiddlewareapplicator" class="tsd-kind-icon">CRUUDMiddleware<wbr>Applicator</a>
					</li>
					<li class=" tsd-kind-type-alias">
						<a href="modules.html#cruudrequest" class="tsd-kind-icon">CRUUDRequest</a>
					</li>
					<li class=" tsd-kind-type-alias">
						<a href="modules.html#cruudresponse" class="tsd-kind-icon">CRUUDResponse</a>
					</li>
					<li class=" tsd-kind-variable">
						<a href="modules.html#cruud_methods" class="tsd-kind-icon">CRUUD_<wbr>METHODS</a>
					</li>
					<li class=" tsd-kind-variable">
						<a href="modules.html#http_methods" class="tsd-kind-icon">HTTP_<wbr>METHODS</a>
					</li>
					<li class=" tsd-kind-function">
						<a href="modules.html#applymiddleware" class="tsd-kind-icon">apply<wbr>Middleware</a>
					</li>
					<li class=" tsd-kind-function">
						<a href="modules.html#createconnector" class="tsd-kind-icon">create<wbr>Connector</a>
					</li>
					<li class=" tsd-kind-function">
						<a href="modules.html#createcruudfns" class="tsd-kind-icon">create<wbr>Cruud<wbr>Fns</a>
					</li>
					<li class=" tsd-kind-function">
						<a href="modules.html#defaultnetworkadapter" class="tsd-kind-icon">default<wbr>Network<wbr>Adapter</a>
					</li>
					<li class=" tsd-kind-function">
						<a href="modules.html#verifyrequest" class="tsd-kind-icon">verify<wbr>Request</a>
					</li>
				</ul>
			</nav>
		</div>
	</div>
</div>
<footer>
	<div class="container">
		<h2>Legend</h2>
		<div class="tsd-legend-group">
			<ul class="tsd-legend">
				<li class="tsd-kind-property tsd-parent-kind-interface"><span class="tsd-kind-icon">Property</span></li>
			</ul>
		</div>
	</div>
</footer>
<div class="overlay"></div>
<script src="assets/js/main.js"></script>
</body>
</html>